package me.moomoo.anarchyexploitfixes.config;

import me.moomoo.anarchyexploitfixes.AnarchyExploitFixes;
import org.bukkit.configuration.InvalidConfigurationException;
import org.bukkit.configuration.file.FileConfiguration;
import org.bukkit.configuration.file.YamlConfiguration;

import java.io.File;
import java.io.IOException;

public class LanguageCache {
    private final FileConfiguration fileConfiguration;
    boolean addedMissing = false;
    public String noPermissions , building_BuildHeightIsAt, building_IsCompletelyDenied, building_CantPlaceThisBlock, building_BedRespawnpointSet,
            elytra_YouAreFlyingIn, elytra_New, elytra_Old, elytra_Speed, elytra_DisabledDueToLowTPS,
            elytra_AtSpawn_Disabled, elytra_AtSpawn_Chunks, elytra_AtSpawn_NewChunksTooFast, elytra_AtSpawn_OldChunksTooFast,
            elytra_EverywhereElse_Disabled, elytra_EverywhereElse_Chunks, elytra_EverywhereElse_NewChunksLowTPS,
            elytra_EverywhereElse_NewChunksTooFast, elytra_EverywhereElse_OldChunksLowTPS, elytra_EverywhereElse_OldChunksTooFast,
            elytra_OnNetherCeiling_Disabled, elytra_OnNetherCeiling_Chunks, elytra_OnNetherCeiling_NewChunksLowTPS,
            elytra_OnNetherCeiling_NewChunksTooFast, elytra_OnNetherCeiling_OldChunksLowTPS, elytra_OnNetherCeiling_OldChunksTooFast,
            general_AccessIsBlocked, general_MovingIsBlocked, player_YouAreMovingIn, player_New, player_Old, player_Speed, player_AtSpawn_Chunks,
            player_AtSpawn_NewChunksTooFast, player_AtSpawn_OldChunksTooFast, player_AtSpawn_OldChunksTooFastSpecificBlocks, general_TeleportingIsBlocked,
            player_AtSpawn_NewChunksTooFastSpecificBlocks, player_EverywhereElse_Chunks, player_EverywhereElse_NewChunksLowTPS,
            player_EverywhereElse_NewChunksTooFast, player_EverywhereElse_OldChunksLowTPS, player_EverywhereElse_OldChunksTooFast,
            player_EverywhereElse_OldChunksTooFastSpecificBlocks, player_EverywhereElse_NewChunksTooFastSpecificBlocks, player_OnNetherCeiling_Chunks,
            player_OnNetherCeiling_NewChunksLowTPS, player_OnNetherCeiling_NewChunksTooFast, player_OnNetherCeiling_OldChunksLowTPS,
            player_OnNetherCeiling_OldChunksTooFast, player_OnNetherCeiling_OldChunksTooFastSpecificBlocks, player_OnNetherCeiling_NewChunksTooFastSpecificBlocks,
            portals_CantCreatePortal, portals_PortalToCeilingCantBeUsed, portals_PortalCantBeUsed, potions_RemovedEffect, potions_UpdatedEffect, vehicle_CantMountVehicle,
            vehicle_YouAreTravelingIn, vehicle_New, vehicle_Old, vehicle_Speed, vehicle_AtSpawn_Chunks, vehicle_AtSpawn_NewChunksTooFast,
            vehicle_AtSpawn_OldChunksTooFast, vehicle_AtSpawn_OldChunksTooFastSpecificBlocks, vehicle_AtSpawn_NewChunksTooFastSpecificBlocks,
            vehicle_EverywhereElse_Chunks, vehicle_EverywhereElse_NewChunksLowTPS, vehicle_EverywhereElse_NewChunksTooFast, vehicle_EverywhereElse_OldChunksLowTPS,
            vehicle_EverywhereElse_OldChunksTooFast, vehicle_EverywhereElse_OldChunksTooFastSpecificBlocks, vehicle_EverywhereElse_NewChunksTooFastSpecificBlocks,
            vehicle_OnNetherCeiling_Chunks, vehicle_OnNetherCeiling_NewChunksLowTPS, vehicle_OnNetherCeiling_NewChunksTooFast, vehicle_OnNetherCeiling_OldChunksLowTPS,
            vehicle_OnNetherCeiling_NewChunksTooFastSpecificBlocks, vehicle_OnNetherCeiling_OldChunksTooFast, vehicle_OnNetherCeiling_OldChunksTooFastSpecificBlocks,
            vehicle_DisabledDueToLowTPS;
    public LanguageCache(String lang) {
        AnarchyExploitFixes plugin = AnarchyExploitFixes.getInstance();
        File langFile = new File(plugin.getDataFolder() + File.separator + "lang", lang + ".yml");
        fileConfiguration = new YamlConfiguration();

        if (!langFile.exists()) {
            langFile.getParentFile().mkdirs();
            plugin.saveResource("lang" + File.separator + lang + ".yml", false);
        }
        try {
            fileConfiguration.load(langFile);

            // Chat
            this.noPermissions = getStringTranslation("no-permission", "You don't have permission to use this command.");

            // Elytra Section


            if (addedMissing) fileConfiguration.save(langFile);
        } catch (IOException e) {
            e.printStackTrace();
        } catch (InvalidConfigurationException e) {
            AnarchyExploitFixes.getInstance().getLogger().warning("Translation file " + langFile + " is not formatted properly. Skipping it.");
        }
    }

    public String getStringTranslation(String path, String defaultTranslation) {
        String translation = fileConfiguration.getString(path);
        if (translation == null) {
            fileConfiguration.set(path, defaultTranslation);
            addedMissing = true;
            return defaultTranslation;
        }
        return translation;
    }
}
