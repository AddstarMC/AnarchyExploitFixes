package me.moomoo.anarchyexploitfixes.modules;

import com.comphenix.protocol.ProtocolLibrary;
import me.moomoo.anarchyexploitfixes.AnarchyExploitFixes;
import me.moomoo.anarchyexploitfixes.modules.chat.*;
import me.moomoo.anarchyexploitfixes.modules.chunklimits.*;
import me.moomoo.anarchyexploitfixes.modules.elytra.*;
import me.moomoo.anarchyexploitfixes.modules.misc.*;
import me.moomoo.anarchyexploitfixes.modules.options1b1t.*;
import me.moomoo.anarchyexploitfixes.modules.patches.*;
import me.moomoo.anarchyexploitfixes.modules.patches.CrashExploits.*;
import me.moomoo.anarchyexploitfixes.modules.patches.DupeFixes.*;
import me.moomoo.anarchyexploitfixes.modules.patches.Illegals.Items.*;
import me.moomoo.anarchyexploitfixes.modules.patches.LagExploits.SnowballExploit;
import me.moomoo.anarchyexploitfixes.modules.patches.PacketPatches.*;
import me.moomoo.anarchyexploitfixes.modules.preventions.NetherPortals.*;
import me.moomoo.anarchyexploitfixes.modules.preventions.*;
import me.moomoo.anarchyexploitfixes.modules.redstone.*;
import me.moomoo.anarchyexploitfixes.modules.preventions.Withers.*;
import me.moomoo.anarchyexploitfixes.modules.bedrock.*;
import org.bukkit.Bukkit;
import org.bukkit.event.HandlerList;

import java.util.HashSet;

public interface AnarchyExploitFixesModule {

    String name();
    String category();
    void enable();
    boolean shouldEnable();

    HashSet<AnarchyExploitFixesModule> modules = new HashSet<>();

    static void reloadModules() {
        modules.clear();
        AnarchyExploitFixes plugin = AnarchyExploitFixes.getInstance();
        plugin.enabledModules.clear();
        plugin.getServer().getScheduler().cancelTasks(plugin);
        HandlerList.unregisterAll(plugin);
        if (Bukkit.getPluginManager().isPluginEnabled("ProtocolLib")) {
            ProtocolLibrary.getProtocolManager().removePacketListeners(plugin);
        }

        // Bedrock
        modules.add(new FillNetherCeilingOnChunkload());
        modules.add(new FillNetherFloorOnChunkload());
        modules.add(new FillOverworldFloorOnChunkload());
        modules.add(new PeriodicallyFillNetherCeiling());
        modules.add(new PeriodicallyFillNetherFloor());
        modules.add(new PeriodicallyFillOverworldFloor());
        modules.add(new PreventGoingBelowBedrockFloor());

        // Chat
        modules.add(new BannedRegex());
        modules.add(new BannedWords());
        modules.add(new CharacterLimit());
        modules.add(new CommandWhitelist());
        modules.add(new FixChatCoIgnore());
        modules.add(new PreventChatSpam());
        modules.add(new PreventCommandSpam());
        modules.add(new PreventLinks());
        modules.add(new PreventLinkSpam());
        modules.add(new PreventUnicodeDot());
        modules.add(new ReplaceAt());

        // Chunklimits
        modules.add(new BlockLimit());
        modules.add(new CustomEntityLimit());
        modules.add(new ExpBottleLimit());
        modules.add(new FallingBlockLimit());
        modules.add(new FallingBlocksLowTPS());
        modules.add(new VehicleLimit());
        modules.add(new NonLivingEntityLimit());

        // Elytra
        modules.add(new ElytraAtSpawn());
        modules.add(new ElytraGlobal());
        modules.add(new ElytraOnCeiling());
        modules.add(new NewChunksListener());
        modules.add(new ElytraPacketFly());

        // 1b1t Options
        modules.add(new BypassSlots());
        modules.add(new DisableNCPGeyser());
        modules.add(new DistanceAwayToTP());
        modules.add(new HurtCommands());
        modules.add(new NickResetOnly());
        modules.add(new PlaceBedrock());
        modules.add(new SlowDupe());
        modules.add(new UseSparkHealth());

        // Misc
        modules.add(new FirstJoinMessage());
        modules.add(new JoinLeaveMessages());
        modules.add(new MaskKickMessages());
        modules.add(new PreventSpamKick());

        /*
            Patches
        */
        modules.add(new BookBan());
        modules.add(new BowBomb());
        modules.add(new Burrow());
        modules.add(new CommandSign());
        modules.add(new EndPortalDestruction());
        modules.add(new GodMode());
        modules.add(new InvalidNames());
        modules.add(new TeleportCoordExploit());
        // Crash Exploits
        modules.add(new DispenserCrash());
        modules.add(new EndGatewayCrash());
        modules.add(new MultipleEnderdragons());
        // Dupe fixes
        modules.add(new ChestedEntitiesInPortals());
        modules.add(new ChestsOnEntities()); // testing needed
        modules.add(new EndPortalDupe());
        modules.add(new ExpDupePatch1());
        modules.add(new ExpDupePatch2());
        // Illegals
        modules.add(new BannedBlocks());
        modules.add(new RemoveIllegalGoldenApples());
        modules.add(new RemovePlayerHeadItems());
        modules.add(new RemoveSpawnEggs());
        modules.add(new RemoveSpecificDataValues());
        modules.add(new RemoveSpecificItemNames());
        modules.add(new RevertOverEnchanted());
        modules.add(new RevertOverstacked());
        modules.add(new RevertSpecificEnchants());
        modules.add(new RevertUnbreakables());
        modules.add(new RevertUnenchantable());
        // Lag Exploits
        modules.add(new SnowballExploit());
        // Packet Patches
        modules.add(new BoatFly());
        modules.add(new NoCom());
        modules.add(new PacketFly());
        modules.add(new CraftingRecipeLag());

        /*
            Preventions
        */
        modules.add(new AntiBedTrap());
        modules.add(new DisableFish());
        modules.add(new Explosions());
        modules.add(new NetherRoof());
        // Nether Portals
        modules.add(new PreventAllEntitiesInPortals());
        modules.add(new PreventDroppedItemsInPortals());
        modules.add(new PreventFireworksInPortals());
        modules.add(new PreventPortalTraps());
        modules.add(new PreventProjectilesInPortals());
        // Withers
        modules.add(new DisableWitherSkulls());
        modules.add(new RemoveAllSkullsPeriodically());
        modules.add(new RemoveSkullsAfterXTicks());
        modules.add(new RemoveSkullsOnChunkload());
        modules.add(new RemoveSkullsOnChunkunload());
        modules.add(new WitherSpawningAtSpawn());

        // Redstone
        modules.add(new DisableRedstoneOnLowTPS());
        modules.add(new RateLimitLevers());

        for (AnarchyExploitFixesModule module : modules) {
            if (module.shouldEnable()) {
                module.enable();
                plugin.enabledModules.put("("+module.category()+") "+module.name(), true);
            } else {
                plugin.enabledModules.put("("+module.category()+") "+module.name(), false);
            }
        }
    }
}
